### 1. Основная идея главы

- **Цель тестирования безопасности:**  
    Обеспечить надежную защиту приложения от киберпреступлений, предотвращая несанкционированный доступ, утечку данных, финансовые потери и ущерб репутации.
    
- **Принцип многослойной защиты:**  
    Надежная система строится за счет защиты на всех уровнях – от входных данных до инфраструктуры, поскольку система защищена настолько, насколько прочное её слабое звено.
    
- **Раннее тестирование безопасности:**  
    Необходимо начинать анализ угроз и тестирование безопасности уже на этапе сбора требований и разработки, чтобы исправлять дефекты до финальной поставки.
    

---

### 2. Основные понятия и терминология

- **Активы (ресурсы):**  
    Ключевые данные и функциональные элементы приложения, требующие защиты (например, личные данные клиентов, финансовая информация, инфраструктура).
    
- **Уязвимости:**  
    Потенциальные слабые места в системе, через которые злоумышленники могут проникнуть.
    
- **Угрозы:**  
    Возможные негативные действия или события, способные воспользоваться уязвимостями.
    
- **Атаки:**  
    Реальные действия злоумышленников, направленные на компрометацию системы.
    
- **Шифрование и хеширование:**  
    Технологии для защиты данных: шифрование превращает информацию в нечитабельную форму, а хеширование – одностороннее преобразование для проверки целостности.
    

---

### 3. Распространённые типы кибератак

- **Веб-скрапинг:**  
    Автоматический сбор данных с веб-сайта, что может привести к утечке личной информации.
    
- **Метод перебора (Brute-force):**  
    Атака, при которой злоумышленник последовательно пытается угадать пароль или другие секретные данные.
    
- **Социальная инженерия и фишинг:**  
    Манипуляция пользователями для получения конфиденциальной информации через мошеннические звонки или электронные письма.
    
- **Межсайтовый скриптинг (XSS):**  
    Внедрение вредоносного JavaScript-кода, позволяющего захватить управление сеансом пользователя или изменить содержимое страницы.
    
- **Программы-вымогатели:**  
    Вредоносное ПО, блокирующее доступ к системе до выплаты выкупа.
    
- **Подделка cookie-файлов:**  
    Манипуляция данными, хранящимися в cookie, что позволяет получить доступ к учетным записям.
    
- **Криптоджекинг:**  
    Незаконное использование ресурсов устройства для майнинга криптовалют.
    

---

### 4. Модель угроз STRIDE

- **STRIDE** – структурированный подход к оценке угроз, где каждая буква обозначает класс угроз:
    - **S (Spoofing):** Спуфинг – выдача себя за другого пользователя или систему.
    - **T (Tampering):** Подмена входных данных или изменение кода с целью нарушения целостности.
    - **R (Repudiation):** Отказ от совершенных действий, отсутствие доказательств аудита.
    - **I (Information Disclosure):** Раскрытие конфиденциальной информации неавторизованным лицам.
    - **D (Denial of Service):** Атаки, направленные на отказ в обслуживании (DoS/DDoS).
    - **E (Elevation of Privileges):** Несанкционированное повышение прав доступа.

---

### 5. Моделирование угроз

- **Этапы моделирования угроз:**
    1. **Определение функции:**  
        Проанализируйте, какие пользовательские сценарии и потоки данных существуют в системе.
    2. **Определение активов:**  
        Выделите критически важные данные (заказы, личные данные клиентов, инфраструктуру).
    3. **Анализ с позиции злоумышленника:**  
        Думайте, как атаковать систему, используя модель STRIDE. Записывайте идеи (например, спуфинг учетных данных, SQL-инъекции, XSS).
    4. **Приоритезация угроз:**  
        Оцените вероятность и потенциальный ущерб, сформируйте истории злоумышленников и свяжите их с тестовыми сценариями.

---

### 6. Тестовые сценарии защиты

- **На уровне пользовательского интерфейса:**
    
    - Проверка истечения времени сеанса и автоматического выхода пользователя.
    - Блокировка учетных данных после серии неудачных попыток входа.
    - Санитизация ввода (отсечение попыток внедрения кода или SQL-инъекций).
    - Ограничение прав пользователей во избежание злоупотребления правами.
- **На уровне API:**
    
    - Отслеживание использования токенов доступа: истекшие токены должны приводить к ответу 401 Unauthorized.
    - Проверка валидации параметров API для защиты от внедрения недопустимых данных.
    - Защита конечных точек, например от использования недопустимых токенов.
- **На уровне базы данных:**
    
    - Хранение паролей в виде хешей (с использованием современных алгоритмов).
    - Шифрование конфиденциальных данных клиентов.
- **На уровне логов:**
    
    - Отсутствие конфиденциальных данных (пароли, личная информация) в логах.
    - Полное логирование действий системы и пользователей для аудита.

---

### 7. Инструменты тестирования безопасности

- **Статическое тестирование безопасности (SAST):**
    
    - Анализ исходного кода для выявления известных уязвимостей.
    - Примеры: Snyk IDE, Talisman (сканирование коммитов).
- **Анализ состава (SCA):**
    
    - Поиск уязвимостей во внешних зависимостях и библиотеках.
    - Примеры: OWASP Dependency-Check, Snyk.
- **Динамическое тестирование (DAST):**
    
    - Тестирование приложения в режиме «черного ящика» с имитацией атак.
    - Примеры: OWASP ZAP, Burp Suite.
    - **OWASP ZAP:**
        - Позволяет проводить пассивное и активное сканирование.
        - Функции ручного исследования (Manual Explore, Spider) и активного сканирования для выявления уязвимостей (например, SQL-инъекции, XSS).
        - Возможность интеграции с CI через API и CLI.
- **Интерактивное тестирование (IAST):**
    
    - Объединяет SAST и DAST для анализа поведения приложения в реальном времени.
    - Примеры: Contrast Security, Acunetix.
- **Ручное исследовательское тестирование:**
    
    - Использование Chrome DevTools и Postman для тестирования сценариев безопасности (настройка передачи токенов, анализ HTTPS, проверка безопасности ресурсов сторонних сайтов).
- **Дополнительные инструменты:**
    
    - **Snyk JetBrains IDE Plugin:** автоматизированное сканирование кода во время разработки.
    - **Talisman:** сканирует коммиты на наличие секретов.
    - **Testcontainers:** для создания одноразовых экземпляров баз данных и других сервисов для тестирования.

---

### 8. Принципы и стратегия тестирования безопасности

- **Защита на всех уровнях:**  
    Внедряйте меры безопасности начиная с этапа анализа требований и продолжая до финального тестирования, чтобы обеспечить «нулевое доверие» (zero trust).
    
- **Моделирование угроз:**  
    Регулярно проводите групповые сессии по моделированию угроз для каждой пользовательской истории, используя модель STRIDE.
    
    - Это помогает выявить слабые звенья и создать истории злоумышленников, на основе которых разрабатываются тестовые сценарии.
- **Интеграция в CI/CD:**  
    Автоматизируйте запуск инструментов SAST, SCA и DAST (например, Talisman, OWASP Dependency-Check, OWASP ZAP) в рамках конвейеров CI для непрерывной обратной связи о безопасности.
    
- **Непрерывное тестирование безопасности:**  
    Не ждите этапа тестирования на проникновение – встраивайте автоматизированные проверки безопасности на ранних этапах разработки.
    
- **Культура безопасности:**  
    Сделайте защиту привычкой – регулярно задавайте себе вопросы: "Могут ли какие-либо простые, непреднамеренные действия привести к компрометации?"  
    Обеспечьте, чтобы все члены команды осознавали ответственность за безопасность.
    

---

### 9. Ключевые выводы

- **Киберпреступность – реальность современности:**  
    Глобальные потери достигают триллионов долларов, а атаки (например, на социальные сети, банковские системы) становятся все более изощренными.
    
- **Защита должна быть многослойной:**  
    Система защищена лишь настолько, насколько прочное её слабое звено. Необходимо внедрять меры безопасности на уровне UI, API, базы данных, логов и инфраструктуры.
    
- **Модель STRIDE помогает структурировать анализ угроз:**  
    Она позволяет систематически рассматривать типы угроз и разрабатывать соответствующие тестовые сценарии.
    
- **Интеграция инструментов безопасности в CI/CD обеспечивает быструю обратную связь:**  
    Автоматические сканирования (SAST, SCA, DAST) позволяют выявлять уязвимости на ранних этапах разработки, снижая затраты на их исправление.
    
- **Культура безопасности – ключ к устойчивости системы:**  
    Все члены команды должны мыслить как хакеры, предвидеть потенциальные угрозы и внедрять защитные меры, делая безопасность неотъемлемой частью жизненного цикла разработки.
