# Глава 6. Ссылки на объекты, изменяемость и повторное использование

- **Переменные — не контейнеры**: В Python переменные — это не "коробки", как в некоторых языках программирования, а ярлыки, которые ссылаются на объекты. Переменные прикрепляются к объектам, а не наоборот. Когда присваивается `a = b`, обе переменные ссылаются на один и тот же объект, а не копируют его.
- **Идентичность и равенство**:
    - Оператор `is` проверяет, являются ли два объекта одним и тем же в памяти.
    - Оператор `==` проверяет равенство значений объектов.
    - Пример: `a = [1, 2]`, `b = a` — обе переменные указывают на один объект в памяти.
- **Изменяемость и кортежи**:
    - Кортежи в Python неизменяемы, но если они содержат изменяемые объекты (например, списки), то значения этих объектов могут изменяться.
    - Пример: `t = (1, [2, 3])` — список внутри кортежа можно изменять, что меняет значение кортежа.
- **Поверхностные и глубокие копии**:
    - Поверхностная копия (shallow copy) создает новый объект, но копирует ссылки на вложенные объекты.
    - Глубокая копия (deep copy) создает новый объект и рекурсивно копирует все вложенные объекты, чтобы они не ссылались на исходные.
    - Использование: модуль `copy` предоставляет функции `copy()` и `deepcopy()`.
- **Аргументы функций**:
    - В Python используется механизм передачи аргументов по "share" (call by sharing). Функция получает копии ссылок на объекты, поэтому изменяемые объекты могут изменяться внутри функции, но сами ссылки нельзя перезаписать.
    - Пример: изменение списка внутри функции отразится на оригинальном объекте.
- **Опасность изменяемых значений по умолчанию**:
    - Использование изменяемых значений (например, списка) в качестве значения по умолчанию может привести к неожиданному поведению, так как все вызовы функции будут использовать один и тот же объект.
    - Рекомендуется использовать `None` и инициализировать внутри функции новый объект при необходимости.
- **Управление памятью и сборка мусора**:
    - В CPython объекты удаляются, когда количество ссылок на них становится нулевым (reference counting). Также есть сборщик мусора для циклических ссылок. Он следит что если внешних ссылок не осталось, а объекты ссылаются друг на друга, то у него есть специальный механизм для их обнаружения.
    - Оператор `del` удаляет ссылки, но не гарантирует немедленного удаления объектов.
- **Слабые ссылки (weak references)**:
    - Механизм слабых ссылок позволяет создать ссылку на объект, не увеличивая счетчик ссылок. Полезно для кешей, чтобы не удерживать объекты в памяти, если на них нет других ссылок.
- **Особенности неизменяемых объектов**:
    - Python может оптимизировать и "интернировать" небольшие неизменяемые объекты, такие как строки и небольшие числа, чтобы экономить память. Поэтому использование оператора `is` для сравнения таких объектов может вести к неожиданным результатам.
    - Для сравнения значений всегда следует использовать `==`.