# Параметры представлений и маршрутов в Django

Owner: Андрей Королев
Last edited time: December 5, 2024 7:05 PM

### Передача параметров через URL

- Параметры URL (или параметры маршрута) позволяют передавать данные в функции-представления прямо из адресной строки.
- Пример: запрос **`http://127.0.0.1:8000/user/Tom/38/`** передаёт значения `Tom` и `38` как параметры.

---

### Шаг 1: Добавление параметров в представление

В файле **`views.py`** добавим функции:

```python
from django.http import HttpResponse

def user(request, name):
    return HttpResponse(f'<h2>Имя: {name}</h2>')
```

- **Пример функции `user`**:
    - Принимает параметр `name`.
    - Отображает переданное значение в HTML.

---

### Шаг 2: Настройка маршрутов с параметрами

В файле **`urls.py`** задаём маршруты с параметрами:

```python
from django.urls import path
from blog import views

urlpatterns = [
    path('user/<str:name>/', views.user),  # Маршрут с параметром name
]
```

- **Формат параметров**: `<тип:название>`.
    - Пример: `<str:name>` означает, что `name` — строка.
- **Обязательные параметры**:
    - Если в URL не передать параметр `name`, возникнет ошибка 404.

---

### Шаг 3: Использование нескольких параметров

Добавим второй параметр в функцию `user`:

```python
def user(request, name, age):
    return HttpResponse(f'<h2>Имя: {name} Возраст: {age}</h2>')
```

И обновим маршрут:

```python
path('user/<str:name>/<int:age>/', views.user),
```

- Пример:
    - Запрос **`http://127.0.0.1:8000/user/Tom/38`**:
        - `Tom` передаётся в параметр `name`.
        - `38` передаётся в параметр `age`.

---

### Шаг 4: Значения по умолчанию для параметров

Чтобы избежать ошибок 404, можно задать значения по умолчанию:

```python
def user(request, name='Undefined', age=0):
    return HttpResponse(f'<h2>Имя: {name} Возраст: {age}</h2>')
```

И добавить дополнительные маршруты в **`urls.py`**:

```python
urlpatterns = [
    path('user/<str:name>/<int:age>/', views.user),  # Полный маршрут
    path('user/<str:name>/', views.user),           # Только с name
    path('user/', views.user),                      # Без параметров
]
```

- Примеры запросов:
    - **`http://127.0.0.1:8000/user/Tom/38`**: `Имя: Tom, Возраст: 38`.
    - **`http://127.0.0.1:8000/user/Tom`**: `Имя: Tom, Возраст: 0`.
    - **`http://127.0.0.1:8000/user/`**: `Имя: Undefined, Возраст: 0`.

---

### Шаг 5: Спецификаторы параметров маршрутов

Django предоставляет следующие спецификаторы:

- **`str`**: Любая строка, кроме символа `/` (по умолчанию).
- **`int`**: Целые числа (включая 0).
- **`slug`**: Латинские буквы, цифры, дефисы, подчеркивания.
- **`uuid`**: Идентификаторы UUID (например, `075194d3-6885-417e-a8a8-6c931e272f00`).
- **`path`**: Любая строка, включая `/`.

Пример использования спецификаторов:

```python
path('product/<slug:slug>/', views.product),
path('uuid/<uuid:id>/', views.product_by_uuid),
```

---

### Итоги

- **Параметры маршрутов** позволяют передавать данные в функции-представления.
- Маршруты задаются через `<тип:название>`, где `тип` определяет ожидаемый формат данных.
- Используйте значения по умолчанию для параметров, чтобы избежать ошибок 404.
- Django предоставляет несколько типов спецификаторов, включая `str`, `int`, `slug`, `uuid`, и `path`.