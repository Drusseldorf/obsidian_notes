# 11.16 Откуда ещё можно делать выборку

Чтобы выбрать данные из таблицы, можно использовать следующие методы:

### Выборка из обычной таблицы

```sql
SELECT name FROM book;
```

1. Этот запрос выбирает колонку `name` из таблицы `book`.

### Выборка из подзапроса

Подзапрос — это вложенный запрос, который сначала выполняется и возвращает результат, по которому затем делается еще один запрос.

```sql
SELECT description FROM (
    SELECT * FROM author WHERE name = 'Михаил Шолохов'
);
```

1. В данном примере сначала выполняется подзапрос, который выбирает все данные из таблицы `author`, где имя равно `Михаил Шолохов`.
2. Затем внешний запрос выбирает только колонку `description` из результата подзапроса.

Этот подзапрос излишен, так как можно было бы сразу выбрать нужные данные, но он демонстрирует принцип работы.

### Выборка из представления (вьюшки)

Представление (view) — это заранее сохраненный запрос, который можно использовать как таблицу.

```sql
CREATE VIEW book_with_author AS
    SELECT book.name, author.name FROM book JOIN author USING (author_id);

SELECT * FROM book_with_author;
```

1. Сначала создается представление `book_with_author`, которое соединяет таблицы `book` и `author` по `author_id` и выбирает из них соответствующие колонки.
2. Затем можно делать выборку данных из представления, как из обычной таблицы.

Представление сохраняется в базе данных и доступно для просмотра, например, через инструменты вроде DBeaver, где представления обычно находятся в отдельной папке.

### Выборка из функций

В PostgreSQL есть готовые функции, которые могут генерировать данные.

```sql
SELECT num FROM generate_series(1, 10) num;
```

1. Функция `generate_series(1, 10)` генерирует числа от 1 до 10 включительно. Алиас `num` используется для обозначения колонки с результатами.

```sql
SELECT d FROM generate_series(
    '2023-01-01'::date,
    '2023-01-10'::date,
    '1 day'::interval
) d;
```

1. Этот запрос генерирует серию дат с 1 по 10 января 2023 года, с шагом в 1 день. Результат обозначен алиасом `d`.

Эти функции полезны для предварительной подготовки данных для аналитических отчетов.

### Выборка из явно указанных значений (`VALUES`)

`VALUES` позволяет использовать в запросе заранее объявленные данные.

```sql
SELECT * FROM (VALUES
    (1, 'Алексей'),
    (2, 'Пётр'),
    (3, 'Иннокентий')
);
```

1. В этом примере явно указываются значения для каждой строки, которые затем выбираются.

```sql
SELECT * FROM (VALUES
    (1, 'Алексей'),
    (2, 'Пётр'),
    (3, 'Иннокентий')
) t(id, name);
```

1. Здесь алиасы `id` и `name` используются для обозначения колонок в результате.

Использование `VALUES` удобно для тестирования и изучения запросов, без необходимости создания отдельных таблиц.