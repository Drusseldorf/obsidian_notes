# Краткий конспект по модификаторам сравнения и фильтрации запросов в Django ORM

## 1. Основные модификаторы сравнения

Модификаторы в Django ORM используются для формирования условий фильтрации. Они записываются через двойное подчёркивание `__` после имени поля. Основные из них:

- `__exact` – точное совпадение (по умолчанию, можно не указывать).
- `__gt` – больше (>)
- `__gte` – больше или равно (>=)
- `__lt` – меньше (<)
- `__lte` – меньше или равно (<=)
- `__contains` – поиск по вхождению (аналог SQL `LIKE '%фраза%'`) (__contains='фраза')
- `__in` – проверка вхождения в множество (аналог SQL `IN (1, 3, 4)`) (__in=[1, 3, 4])
- `__range` – проверка вхождения в диапазон (аналог SQL `BETWEEN ... AND ...`)(__range=[1, 4])

## 2. Метод filter()

Метод `.filter()` принимает именованные аргументы вида:

```python
<Model>.objects.filter(<поле>__<модификатор>=<значение>)
```

Примеры:

- Поиск мороженого, название которого содержит подстроку «эскимо»:
    
    ```python
    IceCream.objects.filter(title__contains='эскимо')
    ```
    
- Фильтрация по флагу (здесь можно не указывать `__exact`):
    
    ```python
    IceCream.objects.filter(is_on_main=True)
    ```
    

## 3. Метод exclude()

Метод `.exclude()` работает аналогично `.filter()`, но исключает объекты, удовлетворяющие условию. Его синтаксис:

```python
<Model>.objects.exclude(<поле>__<модификатор>=<значение>)
```

Пример:

- Исключаем мороженое, которое не опубликовано:
    
    ```python
    IceCream.objects.exclude(is_published=False)
    ```
    

## 4. Работа с датами

Для работы с датами Django ORM предоставляет специальные модификаторы, позволяющие фильтровать записи по частям даты или по диапазонам:

- **`__range`** – выбрать записи между двумя датами:
    
    ```python
    import datetime
    
    start_date = datetime.date(1890, 1, 1)
    end_date = datetime.date(1895, 3, 31)
    Post.objects.filter(pub_date__range=(start_date, end_date))
    ```
    
- **`__date`** – фильтрация по полной дате:
    
    ```python
    Post.objects.filter(pub_date__date=datetime.date(1890, 1, 1))
    ```
    
- **`__year`**, **`__month`**, **`__day`** – фильтрация по отдельным компонентам даты:
    
    ```python
    Post.objects.filter(pub_date__year=1890)
    Post.objects.filter(pub_date__month__lte=6)  # до июня включительно
    ```
    
- **`__quarter`** – фильтрация по кварталу:
    
    ```python
    Post.objects.filter(pub_date__quarter=1)
    ```
